code was pewrformed by me and chat gpt assisted 